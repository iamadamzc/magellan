A:\1\Magellan\src\discovery.py:45: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  correlation, _ = spearmanr(valid_data[feature_col], valid_data['forward_return'])
A:\1\Magellan\src\discovery.py:45: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  correlation, _ = spearmanr(valid_data[feature_col], valid_data['forward_return'])
A:\1\Magellan\src\discovery.py:45: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  correlation, _ = spearmanr(valid_data[feature_col], valid_data['forward_return'])
============================================================
MAGELLAN SYSTEM READINESS REPORT
============================================================
APCA_API_KEY_ID: Found
  -> Key Prefix: PKO...
Target Endpoint: https://paper-api.alpaca.markets/v2
Data Feed: SIP (Full Market)
============================================================


============================================================
[SIMULATION] Processing SPY
============================================================

[STEP 1] Fetching SPY 1-minute bars from Alpaca (SIP feed)...
[DEBUG] Fetching SPY via SIP feed...
[SUCCESS] Fetched 1854 bars

[STEP 2] Fetching SPY fundamental metrics from FMP...
[FMP] Attempting STABLE quote endpoint for SPY
[SUCCESS] Market Cap: $714,669,071,017, PE: 0.00

[STEP 3] Fetching SPY historical news from FMP (3-day window)...
[FMP] Fetching historical news: https://financialmodelingprep.com/stable/news/stock?symbols=SPY&from=2026-01-04&to=2026-01-08&apikey=B3pG...
[FMP] Fetched 45 articles from 2026-01-04 to 2026-01-08
[FMP] Parsed 45 articles with valid timestamps
[SUCCESS] Retrieved 45 news articles for PIT alignment

[STEP 4] Running feature engineering...
[PIT] API Blackout Detected. Local NLP engaged for 45 articles. Latency: 0.0649s
[PIT] Sentiment aligned: std=0.0815, unique_values=20
[PIT] Sentiment Gating Active. RSI/Vol driving 100% weight. Sent Threshold: 0.4/0.6.
[ALPHA] Master signal generated: mean=0.0000, std=0.0000
[SUCCESS] Feature matrix created with 1834 rows (after warmup trim)

============================================================
[FEATURE_MATRIX] SPY - Last 5 rows:
============================================================
                        close  log_return  ...  sentiment  alpha_score
timestamp                                  ...                        
2026-01-09 00:55:00  689.5900   -0.000174  ...   0.068182          0.0
2026-01-09 00:56:00  689.5500   -0.000058  ...   0.068182          0.0
2026-01-09 00:57:00  689.6000    0.000073  ...   0.068182          0.0
2026-01-09 00:58:00  689.5091   -0.000132  ...   0.068182          0.0
2026-01-09 00:59:00  689.4714   -0.000055  ...   0.068182          0.0

[5 rows x 6 columns]

[STEP 6] Running Optimized Walk-Forward Validation for SPY...
[OPTIMIZER] In-Sample: 1273 bars | Out-of-Sample: 546 bars
[OPTIMIZER] Finding optimal weights on In-Sample data...

============================================================
[OPTIMIZER] Dynamic Weight Optimization Results
============================================================

[OPTIMIZER] Best Weights Found:
  RSI: 80%
  Vol: 10%
  Sent: 10%

Weights tested: 60 combinations
------------------------------------------------------------

Metric                    Static (40/30/30)    Optimized           
------------------------------------------------------------
In-Sample Hit Rate        48.15%               48.55%              
Out-of-Sample Hit Rate    49.08%               49.63%            (+0.55%)
Out-of-Sample P&L         3.67 bps             43.32 bps           
============================================================
[VERDICT] VALIDATION FAILED - Signal remains unreliable
============================================================

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
[SYSTEM] SPY VALIDATION FAILED - SIGNAL IS UNRELIABLE.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
[REASON] Optimized Out-of-Sample Hit Rate < 51% indicates persistent model weakness.
[ACTION] Consider alternative features or longer training window.

============================================================
[SIGNAL STRENGTH REPORT] SPY - Multi-Factor IC Analysis
============================================================

Feature: sentiment -> Target: log_return
----------------------------------------
    5-min horizon IC: +0.0211 (Weak)
   15-min horizon IC: +0.0120 (Noise)
   60-min horizon IC: -0.0088 (Noise)

Feature: rsi_14 -> Target: log_return
----------------------------------------
    5-min horizon IC: +0.0043 (Noise)
   15-min horizon IC: +0.0380 (Weak)
   60-min horizon IC: +0.0196 (Noise)

Feature: volatility_14 -> Target: log_return
----------------------------------------
    5-min horizon IC: -0.0293 (Weak)
   15-min horizon IC: +0.0033 (Noise)
   60-min horizon IC: +0.0110 (Noise)

Feature: volume_zscore -> Target: log_return
----------------------------------------
    5-min horizon IC: -0.0220 (Weak)
   15-min horizon IC: -0.0151 (Noise)
   60-min horizon IC: +0.0242 (Weak)

Feature: alpha_score -> Target: log_return
----------------------------------------
    5-min horizon IC: N/A (insufficient data)
   15-min horizon IC: N/A (insufficient data)
   60-min horizon IC: N/A (insufficient data)

============================================================
[NOTE] IC > 0.02 suggests exploitable alpha; IC > 0.05 is promising.

============================================================
[FEATURE INDEPENDENCE] SPY - Cross-Correlation Analysis
============================================================
Sentiment vs RSI Correlation: +0.0602
  -> INDEPENDENT - good signal diversity
------------------------------------------------------------
[NOTE] |corr| < 0.4 indicates independent signals (desirable for confluence).

============================================================
[COMPLETE] SPY pipeline finished successfully
============================================================
